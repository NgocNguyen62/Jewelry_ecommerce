<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>EShopper - Bootstrap Shop Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="/template2/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/template2/css/style.css" rel="stylesheet">

<!--    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <script src="/js/form.js"></script>
    <style>
        body{
            margin: 10px;
        }
        .preview-order{
            display: flex;
        }
        .form{
            margin: 20px;
            flex: 40%;
        }
        .items-order{
            flex: 60%;
        }
        label.error{
            color: red;
        }
        #map_div{
            height: 300px;
            width: 100%;
        }
    </style>
</head>
<body>
<div th:insert="/client/header2 :: header"></div>
<!-- Page Header Start -->
<div class="container-fluid bg-secondary mb-5">
    <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 300px">
        <h1 class="font-weight-semi-bold text-uppercase mb-3">Thanh toán</h1>
    </div>
</div>
<!-- Page Header End -->
    <div class="preview-order">

        <div class="items-order">
            <h3>Chi tiết đơn hàng</h3>
            <table class="table table-active">
                <tr>
                    <th>Sản phẩm</th>
                    <th>Phân loại</th>
                    <th>Giá gốc</th>
                    <th>Giá khuyến mại</th>
                    <th>Số lượng</th>
                </tr>
                <tr th:each="item : ${items}">
                    <td>
                        <img th:src="${item.product.avatar}" style="width:75px;height:75px;">
                        <br>
                        <span th:text="${item.product.productName}"></span>
                    </td>
                    <td th:text="${item.product.category.getCategoryName()}"></td>
                    <td th:text="${#numbers.formatDecimal(item.product.price, 0, 'COMMA', 0, 'POINT')} + 'đ'"></td>
                    <td th:text="${#numbers.formatDecimal(item.product.discount, 0, 'COMMA', 0, 'POINT')} + 'đ'"></td>
                    <td>
                        <span th:text="${item.quantity}"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="total">Tổng tiền: <span th:text="${#numbers.formatDecimal(order.getTotalPrice(), 0, 'COMMA', 0, 'POINT')} + 'đ'"></span></div>
                        <div>Phí vận chuyển: <span th:text="${#numbers.formatDecimal(order.getShipping(), 0, 'COMMA', 0, 'POINT')} + 'đ'"></span></div>
                        <div>Tổng cộng: <span th:text="${#numbers.formatDecimal(order.getTotalPrice() + shipping, 0, 'COMMA', 0, 'POINT')} + 'đ'"></span></div>
<!--                        <div>Thời gian đặt: <span th:text="${order.getOrderTime()}"></span></div>-->
                    </td>
                </tr>
            </table>
        </div>
        <div class="form">
            <form id="user-receiver" th:object="${order}" th:action="@{order}" method="post">
                <input type="hidden" th:field="*{id}">
                <div class="form-group">
                    <label th:text="'Họ và tên'" th:for="receiverName"></label>
                    <input type="text" th:field="*{receiverName}" class="form-control">
                </div>

                <div class="form-group">
                    <label th:text="'Số điện thoại'" th:for="receiverPhone"></label>
                    <input type="text" th:field="*{receiverPhone}" class="form-control">
                </div>
                <div class="form-group">
                    <label th:text="'Địa chỉ'" th:for="receiverAddress"></label>
                    <input type="text" th:field="*{receiverAddress}" id="address" class="form-control">
                </div>
                <div class="form-group">
                    <label th:text="'Ghi chú'" th:for="note"></label>
                    <textarea type="text" th:field="*{note}"></textarea>
                </div>
                <button type="submit" class="btn btn-block btn-primary my-3 py-3">Đặt hàng</button>
            </form>
        </div>

    </div>
<div id="map_div"></div>
<!-- Footer Start -->
<div th:insert="/client/footer :: footer"></div>
<!-- Footer End -->

<!--<script async-->
<!--        src="https://maps.googleapis.com/maps/api/js?sensor=false&loading=async&callback=initMap">-->
<!--</script>-->
<!--<script>-->
<!--    let map;-->
<!--    // initMap is now async-->
<!--    async function initMap() {-->
<!--        // Request libraries when needed, not in the script tag.-->
<!--        const { Map } = await google.maps.importLibrary("maps");-->
<!--        // Short namespaces can be used.-->
<!--        map = new Map(document.getElementById("map"), {-->
<!--            center: { lat: -34.397, lng: 150.644 },-->
<!--            zoom: 8,-->
<!--        });-->
<!--    }-->

<!--    initMap();-->
<!--</script>-->
<!--<script-->
<!--        src="https://maps.googleapis.com/maps/api/js?callback=initMap&signed_in=true"-->
<!--        async-->
<!--        defer-->
<!--&gt;</script>-->

<!--<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>-->
<script src="/js/map.js"></script>
<script>
    $().ready(function (){
        $("#user-receiver").validate({
            onfocusout: false,
            onkeyup: false,
            onclick: false,
            rules: {
                "receiverName":{
                    required: true,
                },
                "receiverPhone":{
                    required: true,
                    validatePhone: true,
                },
                "receiverAddress":{
                    required: true
                }
            },
            messages: {
                "receiverName":{
                    required: "Nhập vào họ tên người nhận"
                },
                "receiverPhone":{
                    required: "Nhập số điện thoại"
                },
                "receiverAddress":{
                    required: "Nhập địa chỉ"
                }
            },
        })
        $.validator.addMethod("validatePassword", function (value, element) {
            return this.optional(element) || /^(?=.*[!@#$%^&*]).{8,}$/i.test(value);
        }, "Hãy nhập password ít nhất 8 ký tự và ít nhất một kí tự đặc biệt");
        $.validator.addMethod("validatePhone", function (value, element){
            return this.optional(element) || /^(0\d{9})$/.test(value);
        }, "Số điện thoại gồm 10 chữ số bắt đầu bằng 0");
    })
</script>
<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="/template2/lib/easing/easing.min.js"></script>
<script src="/template2/lib/owlcarousel/owl.carousel.min.js"></script>

<!-- Contact Javascript File -->
<script src="/template2/mail/jqBootstrapValidation.min.js"></script>
<script src="/template2/mail/contact.js"></script>

<!-- Template Javascript -->
<script src="/template2/js/main.js"></script>
</body>
</html>